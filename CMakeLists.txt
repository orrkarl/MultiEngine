CMAKE_MINIMUM_REQUIRED(VERSION 3.10)

project(Nraster CXX)

IF(NOT CMAKE_BUILD_TYPE)
	SET(CMAKE_BUILD_TYPE Debug)
ENDIF()

OPTION(BUILD_TESTS "builds the test directory and gtest" ON)
OPTION(BUILD_DEMOS "builds the demo directory" ON)

FIND_PACKAGE(OpenCL REQUIRED)

SET(CMAKE_CXX_STANDARD 17)

IF(WIN32)
	SET(gtest_force_shared_crt ON)
ENDIF(WIN32)

ADD_SUBDIRECTORY(lib)

SET(NRASTER_ALL_INCLUDES ${PROJECT_SOURCE_DIR}/lib/inc)

IF(BUILD_DEMOS)
	SET(BUILD_GLFW ON)
	SET(BUILD_GLEW ON)
ENDIF()

IF (BUILD_TESTS)
	SET(BUILD_GTEST ON)
ENDIF()

ADD_SUBDIRECTORY(dependencies)

IF(BUILD_DEMOS)
	ADD_SUBDIRECTORY(demo)
ENDIF()

IF(BUILD_TESTS)	
	ADD_SUBDIRECTORY(test)
	ENABLE_TESTING()
	ADD_TEST(NAME AllTests COMMAND NrasterTest) # run the executable itself for a better log as it uses GTest
ENDIF()

UNSET(NRASTER_ALL_INCLUDES)

# gpu resources and interface

# GPU API utilities
ADD_LIBRARY(vkr-gpu-utils
        host-interface/APIUtils.cpp)

# Main GPU library
ADD_SPIRV_LIBRARY(
    TARGET vkr-gpu-resources
    NAMESPACE device_side
    GENERATED_HEADER_PATH "host-interface/main/autogenerated/GPUCodeResources.h"
    MACROS "VKR_DEVICE_SIDE"
    HEADERS "shared/device_compatibility.h" "shared/compatibility.h" "shared/triangle_setup_types.h" "Config.comph" "TriangleSetupUtil.comp" "entrypoints/main/TriangleSetup.h"
    SOURCES "entrypoints/main/TriangleSetup.comp")

ADD_LIBRARY(vkr-gpu
        host-interface/main/TriangleSetupAPI.cpp)

TARGET_LINK_LIBRARIES(vkr-gpu
    PRIVATE vkr-gpu-resources
    PRIVATE vkr-gpu-utils
    PRIVATE Vulkan::Vulkan
    PRIVATE vkr-global-compiler-opts)

# Testing GPU library
ADD_SPIRV_LIBRARY(
    TARGET vkr-gpu-test-resources
    NAMESPACE device_side::tests
    GENERATED_HEADER_PATH "host-interface/tests/autogenerated/GPUTestResources.h"
    MACROS "VKR_DEVICE_SIDE;VKR_TESTS"
    HEADERS "shared/device_compatibility.h" "shared/compatibility.h" "shared/triangle_setup_types.h" "Config.comph" "TriangleSetupUtil.comp" "entrypoints/tests/setup/Clipping.h"
    SOURCES "entrypoints/tests/setup/Clipping.comp")

ADD_LIBRARY(vkr-gpu-tests
        host-interface/tests/setup/ClippingAPI.cpp)

TARGET_LINK_LIBRARIES(vkr-gpu-tests
    PRIVATE vkr-gpu-test-resources
    PRIVATE vkr-gpu-utils
    PRIVATE Vulkan::Vulkan
    PRIVATE vkr-global-compiler-opts)
